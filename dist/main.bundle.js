(()=>{"use strict";const t=function(){function t(t){this.square=document.createElement("div"),this.target=t}return t.prototype.block=function(t){this.square=t,this.square.style.width="450px",this.square.style.height="450px",this.square.style.position="absolute",this.square.style.zIndex="100",this.target.appendChild(this.square)},t.prototype.unblock=function(){this.square.remove()},t}(),o=function(){function t(){}return t.BoardSize="450px",t}();var a=function(t,o,a){if(a||2===arguments.length)for(var i,s=0,r=o.length;s<r;s++)!i&&s in o||(i||(i=Array.prototype.slice.call(o,0,s)),i[s]=o[s]);return t.concat(i||Array.prototype.slice.call(o))};(new(function(){function i(){this.tab=[],this.positionTab=[],this.squareTab=[],this.board=document.createElement("div"),this.stage="",this.globalId=0,this.breakpoint=!1,this.emptySlots=0,this.colorArray=["red","blue","green","red","yellow","orange","pink"],this.ballPositionTab=[],this.boxForNextBalls=document.createElement("div"),this.tabForNextBalls=[],this.soft=new t(this.board)}return i.prototype.nextBalls=function(){this.tabForNextBalls=[];for(var t=0;t<3;t++){var o=this.colorArray[this.getRandomInt(0,6)];this.tabForNextBalls.push(o)}this.fillBoxForNextBalls(this.tabForNextBalls)},i.prototype.fillBoxForNextBalls=function(t){for(var o=0;o<t.length;o++){var a=document.createElement("div");a.className="square",a.style.left="".concat(50*o,"px"),a.style.backgroundColor="".concat(t[o]),a.style.borderRadius="30%",this.boxForNextBalls.appendChild(a)}},i.prototype.doNewBalls=function(){this.emptySlots=0;for(var t=2;t<=10;t++)for(var o=2;o<=10;o++)0==this.tab[t][o]&&this.emptySlots++;if(this.emptySlots>3){for(t=0;t<3;t++){var a=this.getRandomInt(2,10),i=this.getRandomInt(2,10),s=this.tabForNextBalls[t];0==this.tab[i][a]?this.createBall(a,i,s):t--}this.nextBalls()}else alert("Game OVER! Score:".concat(this.score))},i.prototype.createBall=function(t,o,a){var i;i={id:this.globalId,x:t,y:o,color:a},this.globalId++,this.ballPositionTab.push(i),this.tab[o][t]=i},i.prototype.getRandomInt=function(t,o){return t=Math.ceil(t),o=Math.floor(o),Math.floor(Math.random()*(o-t+1))+t},i.prototype.clearNumbers=function(){for(var t=0;t<=12;t++)for(var o=0;o<=12;o++)"number"==typeof this.tab[t][o]&&(this.tab[t][o]=0,this.positionTab[t][o]=[])},i.prototype.start=function(){this.nextBalls(),this.boxForNextBalls.className="boxForNextBalls",document.body.appendChild(this.boxForNextBalls),this.board.style.position="absolute",this.board.style.width="".concat(o.BoardSize),this.board.style.height="".concat(o.BoardSize),this.board.className="board",document.body.appendChild(this.board);for(var t=0;t<=12;t++){this.tab[t]=[],this.positionTab[t]=[];for(var a=0;a<=12;a++)0==a||0==t||1==a||1==t||11==a||11==t||12==a||12==t?(this.tab[t][a]="wall",this.positionTab[t][a]="wall"):(this.tab[t][a]=0,this.positionTab[t][a]=[])}for(t=0;t<3;t++){var i=this.getRandomInt(2,10),s=this.getRandomInt(2,10),r=this.colorArray[this.getRandomInt(0,6)];0==this.tab[s][i]?this.createBall(i,s,r):t--}this.recreateBoard()},i.prototype.strike=function(){for(var t=2;t<=10;t++){for(var o=2;o<=10;o++)if(null!=this.tab[t][o].color&&this.tab[t][o].color==this.tab[t+1][o].color&&this.tab[t][o].color==this.tab[t+2][o].color)for(var a=[],i=this.tab[t][o].color,s=0;s<=10&&null!=this.tab[t+s][o].color&&this.tab[t+s][o].color==i;s++){null!=this.tab[t+s][o-2]&&this.tab[t+s][o].color==this.tab[t+s][o-2].color&&this.tab[t+s][o].color==this.tab[t+s][o-1].color&&a.push(-2,-1),null!=this.tab[t+s][o-2]&&null!=this.tab[t+s][o+1].color&&this.tab[t+s][o].color==this.tab[t+s][o+1].color&&this.tab[t+s][o].color==this.tab[t+s][o-2].color&&this.tab[t+s][o].color==this.tab[t+s][o-1].color&&a.push(1,-2,-1),null!=this.tab[t+s][o+2]&&null!=this.tab[t+s][o-1].color&&this.tab[t+s][o].color==this.tab[t+s][o+1].color&&this.tab[t+s][o].color==this.tab[t+s][o+2].color&&this.tab[t+s][o].color==this.tab[t+s][o-1].color&&a.push(1,2,-1),null!=this.tab[t+s][o+2]&&this.tab[t+s][o].color==this.tab[t+s][o+1].color&&this.tab[t+s][o].color==this.tab[t+s][o+2].color&&a.push(1,2),a.push(0);for(var r=[],l=0;l<a.length;l++)r.includes(a[l])||r.push(a[l]);for(var e=r.length-1;e>=0;e--)this.tab[t+s][o+r[e]]=0,this.positionTab[t+s][o+r[e]]=[],this.score++}else if(null!=this.tab[t][o].color&&this.tab[t][o].color==this.tab[t][o+1].color&&this.tab[t][o].color==this.tab[t][o+2].color)for(a=[],i=this.tab[t][o].color,s=0;s<=10&&null!=this.tab[t][o+s].color&&this.tab[t][o+s].color==i;s++){for(null!=this.tab[t-2][o+s]&&this.tab[t][o+s].color==this.tab[t-2][o+s].color&&this.tab[t][o+s].color==this.tab[t-1][o+s].color&&a.push(-2,-1),null!=this.tab[t-2][o+s]&&null!=this.tab[t+1][o+s].color&&this.tab[t][o+s].color==this.tab[t+1][o+s].color&&this.tab[t][o+s].color==this.tab[t-2][o+s].color&&this.tab[t][o+s].color==this.tab[t-1][o+s].color&&a.push(1,-2,-1),null!=this.tab[t+2][o+s]&&null!=this.tab[t-1][o+s].color&&this.tab[t][o+s].color==this.tab[t+1][o+s].color&&this.tab[t][o+s].color==this.tab[t+2][o+s].color&&this.tab[t][o+s].color==this.tab[t-1][o+s].color&&a.push(1,2,-1),null!=this.tab[t+2][o+s]&&this.tab[t][o+s].color==this.tab[t+1][o+s].color&&this.tab[t][o+s].color==this.tab[t+2][o+s].color&&a.push(1,2),a.push(0),r=[],l=0;l<a.length;l++)r.includes(a[l])||r.push(a[l]);for(e=r.length-1;e>=0;e--)this.positionTab[t+r[e]][o+s]=[],this.tab[t+r[e]][o+s]=0,this.score++}this.recreateBoard()}},i.prototype.recreateBoard=function(){var t=this;this.getRandomInt(-80,40),this.board.innerHTML="",this.soft.unblock(),this.squareTab.forEach((function(t){return t.remove()}));for(var o=function(o){for(var i=function(i){var s;0==a.tab[o][i]&&((s=document.createElement("div")).className="square",s.style.top="".concat(50*(o-2),"px"),s.style.left="".concat(50*(i-2),"px"),s.addEventListener("click",(function(){if("firstClick"==t.stage&&0!=t.positionTab[o][i].length){var a,s=document.createElement("div");if(t.soft.block(s),console.log("miejsce przesuneca ",t.tab[o][i]),0!=t.tab[o][i])t.stage="zeroClick",a={id:t.tab[t.ballMovingY][t.ballMovingX].id,x:t.tab[t.ballMovingY][t.ballMovingX].x,y:t.tab[t.ballMovingY][t.ballMovingX].y,color:t.tab[t.ballMovingY][t.ballMovingX].color},t.tab[t.ballMovingY][t.ballMovingX]=0,t.tab[o][i]=a,t.clearNumbers(),t.doNewBalls(),t.squareTab.forEach((function(t){return t.style.backgroundColor="grey"})),setTimeout((function(){return t.strike()}),1e3)}})),s.addEventListener("mouseover",(function(){t.colorPath(t.positionTab[o][i])})),a.board.append(s)),"object"==typeof a.tab[o][i]&&((s=document.createElement("div")).className="square",s.style.top="".concat(50*(o-2),"px"),s.style.left="".concat(50*(i-2),"px"),s.style.backgroundColor="".concat(a.tab[o][i].color),s.style.borderRadius="30%",s.addEventListener("click",(function(){t.clearNumbers(),console.log(t.positionTab),console.log(t.positionTab[o][i]),t.positionTab[o][i]=["".concat(o,"_").concat(i)],t.pathStart(t.tab[o][i],o,i),t.ballMovingY=o,t.ballMovingX=i,t.stage="firstClick"})),a.board.append(s))},s=2;s<=10;s++)i(s)},a=this,i=2;i<=10;i++)o(i)},i.prototype.colorPath=function(t){this.squareTab.forEach((function(t){return t.remove()}));for(var o=1;o<t.length;o++){var a=parseInt(t[o].split("_")[0]),i=parseInt(t[o].split("_")[1]),s=document.createElement("div");s.className="path",s.style.top="".concat(50*(a-2),"px"),s.style.left="".concat(50*(i-2),"px"),s.style.backgroundColor="tomato",this.squareTab.push(s),this.board.append(s)}},i.prototype.pathStart=function(t,o,i){var s=this;if(void 0===o&&(o=1),void 0===i&&(i=1),"object"==typeof t){var r="".concat(o,"_").concat(i);0==this.tab[o+1][i]&&(this.tab[o+1][i]=1,this.positionTab[o+1][i].push(r),this.positionTab[o+1][i].push("".concat(o+1,"_").concat(i))),0==this.tab[o-1][i]&&(this.tab[o-1][i]=1,this.positionTab[o-1][i].push(r),this.positionTab[o-1][i].push("".concat(o-1,"_").concat(i))),0==this.tab[o][i+1]&&(this.tab[o][i+1]=1,this.positionTab[o][i+1].push(r),this.positionTab[o][i+1].push("".concat(o,"_").concat(i+1))),0==this.tab[o][i-1]&&(this.tab[o][i-1]=1,this.positionTab[o][i-1].push(r),this.positionTab[o][i-1].push("".concat(o,"_").concat(i-1))),this.pathStart(1)}else if("number"==typeof t){for(var l=!1,e=2;e<=10;e++)for(var n=2;n<=10;n++)l=!1,this.tab[e][n]==t&&(0==this.tab[e+1][n]&&(this.tab[e+1][n]=t+1,0==this.positionTab[e+1][n].length&&(this.positionTab[e+1][n]=a([],this.positionTab[e][n],!0),this.positionTab[e+1][n].push("".concat(e+1,"_").concat(n))),l=!0),0==this.tab[e-1][n]&&(this.tab[e-1][n]=t+1,0==this.positionTab[e-1][n].length&&(this.positionTab[e-1][n]=a([],this.positionTab[e][n],!0),this.positionTab[e-1][n].push("".concat(e-1,"_").concat(n))),l=!0),0==this.tab[e][n+1]&&(this.tab[e][n+1]=t+1,0==this.positionTab[e][n+1].length&&(this.positionTab[e][n+1]=a([],this.positionTab[e][n],!0),this.positionTab[e][n+1].push("".concat(e,"_").concat(n+1))),l=!0),0==this.tab[e][n-1]&&(this.tab[e][n-1]=t+1,0==this.positionTab[e][n-1].length&&(this.positionTab[e][n-1]=a([],this.positionTab[e][n],!0),this.positionTab[e][n-1].push("".concat(e,"_").concat(n-1))),l=!0));l||setTimeout((function(){return s.pathStart(t+1)}),1)}},i}())).start()})();